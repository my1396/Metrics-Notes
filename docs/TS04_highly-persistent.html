<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>18&nbsp; Highly Persistent TS – Metrics Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./TS05_Forecast.html" rel="next">
<link href="./TS04_Spurious_regression.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-df1527acfa5b01a3df6647be835ee5b1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-d7e68393ef5d1941e622d5c54cfb7d49.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
 
<!-- This is what works with Quarto and MathJax 3+ -->
<script>
  MathJax = {
    tex: {
      inlineMath: [   // start/end delimiter pairs for in-line math
          ['$', '$'],
          ['\\(', '\\)']
        ],
      displayMath: [  // start/end delimiter pairs for display math
        ['$$', '$$'],
        ['\\[', '\\]']
      ],
      processEscapes: true, // use \$ to produce a literal dollar sign
      tags: 'ams',  // should be 'ams', 'none', or 'all'
      macros: {  //define TeX macros
        bold: ["{\\boldsymbol #1}", 1],  // use \bold as a shorthand
        indep: "{\\perp \\!\\!\\! \\perp}",
        vect: ["\\mathbf{#1}", 1],
        mat: ["\\mathbf{#1}", 1], 

        bA: "\\boldsymbol{A}",
        bB: "\\boldsymbol{B}",
        bC: "\\boldsymbol{C}",
        bD: "\\boldsymbol{D}",
        bE: "\\boldsymbol{E}",
        bF: "\\boldsymbol{F}",
        bG: "\\boldsymbol{G}",
        bH: "\\boldsymbol{H}",
        bI: "\\boldsymbol{I}",
        bJ: "\\boldsymbol{J}",
        bK: "\\boldsymbol{K}",
        bL: "\\boldsymbol{L}",
        bM: "\\boldsymbol{M}",
        bN: "\\boldsymbol{N}",
        bP: "\\boldsymbol{P}",
        bQ: "\\boldsymbol{Q}",
        bR: "\\boldsymbol{R}",
        bS: "\\boldsymbol{S}",
        bT: "\\boldsymbol{T}",
        bU: "\\boldsymbol{U}",
        bV: "\\boldsymbol{V}",
        bW: "\\boldsymbol{W}",
        bX: "\\boldsymbol{X}",
        bY: "\\boldsymbol{Y}",
        bZ: "\\boldsymbol{Z}",
        ba: "\\boldsymbol{a}",
        bb: "\\boldsymbol{b}",
        bc: "\\boldsymbol{c}",
        bd: "\\boldsymbol{d}",
        be: "\\boldsymbol{e}",
        bg: "\\boldsymbol{g}",
        bh: "\\boldsymbol{h}",
        bi: "\\boldsymbol{i}",
        bm: "\\boldsymbol{m}",
        bp: "\\boldsymbol{p}",
        bq: "\\boldsymbol{q}",
        br: "\\boldsymbol{r}",
        bs: "\\boldsymbol{s}",
        bt: "\\boldsymbol{t}",
        bu: "\\boldsymbol{u}",
        bv: "\\boldsymbol{v}",
        bw: "\\boldsymbol{w}",
        bx: "\\boldsymbol{x}",
        by: "\\boldsymbol{y}",
        bz: "\\boldsymbol{z}",

        Acal: "\\mathcal{A}",
        Bcal: "\\mathcal{B}",
        Ccal: "\\mathcal{C}",
        Dcal: "\\mathcal{D}",
        Ecal: "\\mathcal{E}",
        Fcal: "\\mathcal{F}",
        Gcal: "\\mathcal{G}",
        Hcal: "\\mathcal{H}",
        Ical: "\\mathcal{I}",
        Jcal: "\\mathcal{J}",
        Kcal: "\\mathcal{K}",
        Lcal: "\\mathcal{L}",
        Mcal: "\\mathcal{M}",
        Ncal: "\\mathcal{N}",
        Ocal: "\\mathcal{O}",
        Pcal: "\\mathcal{P}",
        Qcal: "\\mathcal{Q}",
        Rcal: "\\mathcal{R}",
        Scal: "\\mathcal{S}",
        Tcal: "\\mathcal{T}",
        Ucal: "\\mathcal{U}",
        Vcal: "\\mathcal{V}",
        Wcal: "\\mathcal{W}",
        Xcal: "\\mathcal{X}",
        Ycal: "\\mathcal{Y}",
        Zcal: "\\mathcal{Z}",

        A: "\\mathbb{A}",
        B: "\\mathbb{B}",
        C: "\\mathbb{C}",
        D: "\\mathbb{D}",
        E: "\\mathbb{E}",
        F: "\\mathbb{F}",
        G: "\\mathbb{G}",
        H: "\\mathbb{H}",
        I: "\\mathbb{I}",
        J: "\\mathbb{J}",
        K: "\\mathbb{K}",
        L: "\\mathbb{L}",
        M: "\\mathbb{M}",
        N: "\\mathbb{N}",
        O: "\\mathbb{O}",
        P: "\\mathbb{P}",
        Q: "\\mathbb{Q}",
        R: "\\mathbb{R}",
        S: "\\mathbb{S}",
        T: "\\mathbb{T}",
        U: "\\mathbb{U}",
        V: "\\mathbb{V}",
        W: "\\mathbb{W}",
        X: "\\mathbb{X}",
        Y: "\\mathbb{Y}",
        Z: "\\mathbb{Z}",

        bAlpha: "\\boldsymbol{\\Alpha}",
        bBeta: "\\boldsymbol{\\beta}",
        bDelta: "\\boldsymbol{\\delta}",
        bEta: "\\boldsymbol{\\eta}",
        bGamma: "\\boldsymbol{\\Gamma}",
        bLambda: "\\boldsymbol{\\Lambda}",
        bOmega: "\\boldsymbol{\\Omega}",
        bPhi: "\\boldsymbol{\\Phi}",
        bPi: "\\boldsymbol{\\Pi}",
        bPsi: "\\boldsymbol{\\Psi}",
        bSigma: "\\boldsymbol{\\Sigma}",
        bTau: "\\boldsymbol{\\tau}",
        bXi: "\\boldsymbol{\\Xi}",
        bLambda: "\\boldsymbol{\\Lambda}",
        
        balpha: "\\boldsymbol{\\alpha}",
        bbeta: "\\boldsymbol{\\beta}",
        bepsilon: "\\boldsymbol{\\epsilon}",
        bvarepsilon: "\\boldsymbol{\\varepsilon}",
        bdelta: "\\boldsymbol{\\delta}",
        blambda: "\\boldsymbol{\\lambda}",
        bmu: "\\boldsymbol{\\mu}",
        bphi: "\\boldsymbol{\\phi}",
        bpi: "\\boldsymbol{\\pi}",
        bpsi: "\\boldsymbol{\\psi}",
        brho: "\\boldsymbol{\\rho}",
        bsigma: "\\boldsymbol{\\sigma}",
        btau: "\\boldsymbol{\\tau}",
        bxi: "\\boldsymbol{\\xi}",
        bEta: "\\boldsymbol{\\eta}",
        bPhi: "\\boldsymbol{\\Phi}",
        bPi: "\\boldsymbol{\\Pi}",
        bPsi: "\\boldsymbol{\\Psi}",
        bXi: "\\boldsymbol{\\Xi}",
        blambda: "\\boldsymbol{\\lambda}",
        bmu: "\\boldsymbol{\\mu}",
        bphi: "\\boldsymbol{\\phi}",
        bpi: "\\boldsymbol{\\pi}",
        bpsi: "\\boldsymbol{\\psi}",
        brho: "\\boldsymbol{\\rho}",
        bsigma: "\\boldsymbol{\\sigma}",
                   
        curl: ["\\left\\lbrace#1\\right\\rbrace", 1],
        floor: ["\\left\\lfloor#1\\right\\rfloor", 1],
        ceil: ["\\left\\lceil#1\\right\\rceil", 1],
        abs: ["\\left\\lvert#1\\right\\rvert", 1],
        norm: ["\\left\\lVert#1\\right\\rVert", 1],

        independent: "\\mathrel{\\perp\\!\\!\\perp}",

        var: "\\mathrm{Var}",
        cov: "\\mathrm{Cov}",
        cor: "\\mathrm{Corr}",
        diag: "\\mathrm{diag}",
        rank: "\\mathrm{rank}",
        vecc: "\\mathrm{vec}",
      }
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TS01_AR1.html">Time Series</a></li><li class="breadcrumb-item"><a href="./TS04_highly-persistent.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Highly Persistent TS</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Metrics Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Refresher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conditional_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Expectation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measure_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measure Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_AR1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AR(1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_AR_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AR – Example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_phillips-curve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Phillips Curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_properties_AR1Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Properties of OLS with Serially Correlated Errors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_Correct_AR1Errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Correcting for Serial Correaltion with Strictly Exogenous Regressors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">TS Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS02_lag_poly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Lag polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS02_AR-MA-representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">AR(1) and Its MA representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS03_finite-property.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">OLS Finite Sample Assumptions and Properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS03_OLS_identification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Estimation of Autoregressive Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS03_asymptotic-property.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">OLS Asymptotic Assumptions and Properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_TimeSeries_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Time Series Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_VAR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Vector Autoregressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_Spurious_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Spurious Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_highly-persistent.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Highly Persistent TS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS05_Forecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Forecast</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Panel Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA01_Pooled_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Pooled Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA02_Panel_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Panel Regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA03_Fixed-Effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Fixed Effects Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA04_Random-Effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Random Effects Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA05_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Dynamic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA06_dynamic_models_with_pdynmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Dynamic Model Applications with <code>pdynmc</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA07_Hetero_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Linear Models with Heterogeneous Coefficients</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#testing-for-unit-roots" id="toc-testing-for-unit-roots" class="nav-link active" data-scroll-target="#testing-for-unit-roots"><span class="header-section-number">18.1</span> Testing for Unit Roots</a>
  <ul class="collapse">
  <li><a href="#dickey-fuller-df-test" id="toc-dickey-fuller-df-test" class="nav-link" data-scroll-target="#dickey-fuller-df-test"><span class="header-section-number">18.1.1</span> Dickey-Fuller (DF) Test</a></li>
  <li><a href="#augmented-dickey-fuller-adf-test" id="toc-augmented-dickey-fuller-adf-test" class="nav-link" data-scroll-target="#augmented-dickey-fuller-adf-test"><span class="header-section-number">18.1.2</span> Augmented Dickey-Fuller (ADF) Test</a></li>
  <li><a href="#deterministic-trend" id="toc-deterministic-trend" class="nav-link" data-scroll-target="#deterministic-trend"><span class="header-section-number">18.1.3</span> Deterministic Trend</a></li>
  </ul></li>
  <li><a href="#cointegration" id="toc-cointegration" class="nav-link" data-scroll-target="#cointegration"><span class="header-section-number">18.2</span> Cointegration</a>
  <ul class="collapse">
  <li><a href="#engle-granger-test" id="toc-engle-granger-test" class="nav-link" data-scroll-target="#engle-granger-test"><span class="header-section-number">18.2.1</span> Engle-Granger Test</a></li>
  </ul></li>
  <li><a href="#cointegrated-series" id="toc-cointegrated-series" class="nav-link" data-scroll-target="#cointegrated-series"><span class="header-section-number">18.3</span> Cointegrated Series</a>
  <ul class="collapse">
  <li><a href="#leads-and-lags-estimator" id="toc-leads-and-lags-estimator" class="nav-link" data-scroll-target="#leads-and-lags-estimator"><span class="header-section-number">18.3.1</span> Leads and Lags Estimator</a></li>
  </ul></li>
  <li><a href="#error-correction-models" id="toc-error-correction-models" class="nav-link" data-scroll-target="#error-correction-models"><span class="header-section-number">18.4</span> Error Correction Models</a></li>
  <li><a href="#noncointegrated-series" id="toc-noncointegrated-series" class="nav-link" data-scroll-target="#noncointegrated-series"><span class="header-section-number">18.5</span> Noncointegrated Series</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TS01_AR1.html">Time Series</a></li><li class="breadcrumb-item"><a href="./TS04_highly-persistent.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Highly Persistent TS</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Highly Persistent TS</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Provided the time series we use are weakly dependent, usual OLS inference procedures are valid under assumptions weaker than the classical linear model assumptions. Unfortunately, many economic time series cannot be characterized by weak dependence.</p>
<p>Using time series with strong dependence in regression analysis poses no problem, if the CLM assumptions in finite samples hold. But the usual inference procedures are very susceptible to violation of these assumptions when the data are not weakly dependent, because then we cannot appeal to the law of large numbers and the central limit theorem. In this section, we provide some examples of highly persistent (or strongly dependent) time series and show how they can be transformed for use in regression analysis.</p>
<p>When the time series are highly persistent (they have unit roots), we must exercise extreme caution in using them directly in regression models. An alternative to using the levels is to use the first differences of the variables. For most highly persistent economic time series, the first difference is weakly dependent. Using first differences changes the nature of the model, but this method is often as informative as a model in levels. When data are highly persistent, we usually have more faith in first-difference results.</p>
<section id="testing-for-unit-roots" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="testing-for-unit-roots"><span class="header-section-number">18.1</span> Testing for Unit Roots</h2>
<p>We begin with an AR(1) model:</p>
<p><span id="eq-I1_model"><span class="math display">\[
u_t = \alpha + \rho u_{t-1} + \varepsilon_t, \; t = 2,3,\ldots,
\tag{18.1}\]</span></span> where <span class="math inline">\(\{\varepsilon_t\}\)</span> has zero mean, given past observed <span class="math inline">\(u\)</span>:</p>
<p><span id="eq-assumption"><span class="math display">\[
\E[\varepsilon_t\mid u_{t-1}, u_{t-2}, \ldots] = 0,
\tag{18.2}\]</span></span> that is, <span class="math inline">\(\{\varepsilon_t\}\)</span> is said to be a martingale difference sequence w.r.t. <span class="math inline">\(\{u_{t-1}, u_{t-2}, \ldots\}\)</span>. If <span class="math inline">\(\{\varepsilon_t\}\)</span> is said to be i.i.d. with zero mean, then it also satisfies the assumption (<a href="#eq-assumption" class="quarto-xref"><span>18.2</span></a>).</p>
<ul>
<li>When <span class="math inline">\(\alpha=0\)</span> and <span class="math inline">\(\rho=1\)</span>, then <span class="math inline">\(\{u_t\}\)</span> follows a random walk without drift.</li>
<li>When <span class="math inline">\(\alpha\ne 0\)</span> and <span class="math inline">\(\rho=1\)</span>, then <span class="math inline">\(\{u_t\}\)</span> follows a random walk with drift. We say that the model allows for a <em>deterministic drift</em>.</li>
</ul>
<p>Therefore, the null hypothesis is that <span class="math inline">\(\{u_t\}\)</span> has a unit root:</p>
<p><span class="math display">\[
\begin{split}
\mathrm H_0:  \rho=1 \\
\mathrm H_1:  \rho&lt;1 \\
\end{split}
\]</span> Note that <span class="math inline">\(\mathrm H_1\)</span> is a one-sided alternative. We do not consider that <span class="math inline">\(\rho&gt;1\)</span> as it implies that <span class="math inline">\(u_t\)</span> is explosive.</p>
<p>When <span class="math inline">\(\abs{\rho}&lt;1,\)</span> <span class="math inline">\(\{u_t\}\)</span> is a stable AR(1) process, which means it is weakly dependent or asymptotically uncorrelated.</p>
<section id="dickey-fuller-df-test" class="level3" data-number="18.1.1">
<h3 data-number="18.1.1" class="anchored" data-anchor-id="dickey-fuller-df-test"><span class="header-section-number">18.1.1</span> Dickey-Fuller (DF) Test</h3>
<p>To test for a unit root, we reparameterize the AR(1) model.</p>
<p>Subtract <span class="math inline">\(u_{t-1}\)</span> from both sides of (<a href="#eq-I1_model" class="quarto-xref"><span>18.1</span></a>) and define <span class="math inline">\(\theta=(\rho-1)\)</span>:</p>
<p><span class="math display">\[
\begin{split}
u_t - u_{t-1} &amp;= \alpha + \rho u_{t-1} - u_{t-1} + \varepsilon_t \\
\Rightarrow \Delta u_t &amp;= \alpha + (\rho - 1)u_{t-1} + \varepsilon_t
\end{split}
\]</span> Define <span class="math inline">\(\theta = \rho - 1\)</span>:</p>
<p><span class="math display">\[
\Delta u_t = \alpha + \theta u_{t-1} + \varepsilon_t
\]</span> Testing Hypotheses</p>
<ul>
<li><span class="math inline">\(\mathrm H_0: \theta = 0\)</span> (i.e., <span class="math inline">\(\rho = 1\)</span>, unit root)</li>
<li><span class="math inline">\(\mathrm H_1: \theta &lt; 0\)</span> (i.e., <span class="math inline">\(\rho &lt; 1\)</span>, stationary)</li>
</ul>
<p>Testing Procedure</p>
<ol type="1">
<li><p>Estimate:</p>
<p><span class="math display">\[
\Delta u_t = \alpha + \theta u_{t-1} + \varepsilon_t
\]</span></p></li>
<li><p>Compute the <strong>t-statistic</strong> for <span class="math inline">\(\hat{\theta}\)</span>.</p></li>
<li><p>Compare it to the <strong>Dickey-Fuller critical values</strong> for the case <strong>with intercept (no trend)</strong>.</p></li>
</ol>
<table style="border-collapse: collapse; margin: 20px auto; text-align: center; font-family: Arial, sans-serif; width: 80%;">
<caption style="caption-side: top; background-color: #00a9e0; color: white; font-weight: bold; padding: 10px; text-align: left;">
Asymptotic Critical Values for Unit Root <em>t</em> Test: No Time Trend
</caption>
<tbody>
<tr style="background-color: #f2e6cd; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Significance level
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
1%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
2.5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
10%
</td>
</tr>
<tr style="background-color: #eef7fc; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Critical value
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.43
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.12
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−2.86
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−2.57
</td>
</tr>
</tbody>
</table>
</section>
<section id="augmented-dickey-fuller-adf-test" class="level3" data-number="18.1.2">
<h3 data-number="18.1.2" class="anchored" data-anchor-id="augmented-dickey-fuller-adf-test"><span class="header-section-number">18.1.2</span> Augmented Dickey-Fuller (ADF) Test</h3>
<p>To account for serial correlation in the error term <span class="math inline">\(\varepsilon_t\)</span>, we augment the regression with lagged differences:</p>
<p><span id="eq-ADF"><span class="math display">\[
\Delta u_t = \alpha + \theta u_{t-1} + \sum_{j=1}^{p} \gamma_j \Delta u_{t-j} + \varepsilon_t .
\tag{18.3}\]</span></span></p>
<p>Using <span class="math inline">\(p=1\)</span> as an example:</p>
<p><span class="math display">\[
\Delta u_t = \alpha + \theta u_{t-1} + \gamma_1 \Delta u_{t-1} + \varepsilon_t .
\]</span> where <span class="math inline">\(\abs{\gamma_1}&lt;1\)</span>. This ensures that, under <span class="math inline">\(\mathrm H_0: \theta=0,\)</span> <span class="math inline">\(\{\Delta u_{t}\}\)</span> follows a stable AR(1) model. Under the alternative <span class="math inline">\(\mathrm H_1: \theta&lt;0,\)</span> <span class="math inline">\(\{u_t\}\)</span> follows a stable AR(2) model.</p>
<p>This extended version of the Dickey-Fuller test is usually called the augmented Dickey-Fuller test because the regression has been augmented with the lagged changes, <span class="math inline">\(\Delta u_{t-j}.\)</span> The critical values and rejection rule are the same as before. The inclusion of the lagged changes in (<a href="#eq-ADF" class="quarto-xref"><span>18.3</span></a>) is intended to clean up any serial correlation in <span class="math inline">\(\Delta u_{t}.\)</span></p>
<p>Often, the lag length is dictated by the frequency of the data (as well as the sample size). For annual data, one or two lags usually suffice. For monthly data, we might include 12 lags. But there are no hard rules to follow in any case.</p>
</section>
<section id="deterministic-trend" class="level3" data-number="18.1.3">
<h3 data-number="18.1.3" class="anchored" data-anchor-id="deterministic-trend"><span class="header-section-number">18.1.3</span> Deterministic Trend</h3>
<p>For series that have clear time trends, we need to modify the test for unit roots. A trend-stationary process, which has a linear trend in its mean but is <span class="math inline">\(\mathrm I(0)\)</span> about its trend, can be mistaken for a unit root process if we do not control for a time trend in the Dickey-Fuller regression. In other words, if we carry out the usual DF or augmented DF test on a trending but <span class="math inline">\(\mathrm I(0)\)</span> series, we will probably have little power for rejecting a unit root.</p>
<p>If a deterministic trend is expected in the data, the corresponding model in levels (before differencing) is:</p>
<p><span class="math display">\[
u_t = \alpha + \beta t + \rho u_{t-1} + \varepsilon_t, \quad t = 2,3,\ldots
\]</span></p>
<p>This allows the test to account for both a <strong>deterministic linear trend</strong> and a possible <strong>unit root</strong>.</p>
<p>We change the ADF regression to:</p>
<p><span class="math display">\[
\Delta u_t = \alpha + \delta t + \theta u_{t-1} + \sum_{j=1}^{p} \gamma_j \Delta u_{t-j} + \varepsilon_t
\]</span> where again the testing hypotheses are</p>
<ul>
<li><p><span class="math inline">\(\mathrm H_0: \theta = 0\)</span></p>
<p>If <span class="math inline">\(\{u_t\}\)</span> has a unit root, then <span class="math display">\[
  \Delta u_t = \alpha + \delta t + \sum_{j=1}^{p} \gamma_j \Delta u_{t-j} + \varepsilon_t ,
  \]</span> so the change in <span class="math inline">\(u_t\)</span> has a mean linear in <span class="math inline">\(t\)</span> unless <span class="math inline">\(\delta=0.\)</span></p>
<p>It is unusal for the first difference of an economic series to have a linear trend, so a more appropriate null hypothesis is probably</p>
<p><span class="math display">\[
  \mathrm H_0: \theta = 0, \delta = 0
  \]</span></p></li>
<li><p><span class="math inline">\(\mathrm H_1: \theta &lt; 0\)</span> (trend-stationary process)</p></li>
</ul>
<p>When we include a time trend in the regression, the critical values of the test change. Intuitively, this occurs because detrending a unit root process tends to make it look more like an <span class="math inline">\(\mathrm I(0)\)</span>process. Therefore, we require a larger magnitude for the <span class="math inline">\(t\)</span> statistic in order to reject <span class="math inline">\(\mathrm H_0.\)</span> The Dickey-Fuller critical values for the <span class="math inline">\(t\)</span> test that includes a time trend are given in following table.</p>
<table style="border-collapse: collapse; margin: 20px auto; text-align: center; font-family: Arial, sans-serif; width: 80%;">
<caption style="caption-side: top; background-color: #00a9e0; color: white; font-weight: bold; padding: 10px; text-align: left;">
Asymptotic Critical Values for Unit Root <em>t</em> Test: Linear Time Trend
</caption>
<tbody>
<tr style="background-color: #f2e6cd; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Significance level
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
1%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
2.5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
10%
</td>
</tr>
<tr style="background-color: #eef7fc; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Critical value
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.96
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.66
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.41
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.12
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cointegration" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="cointegration"><span class="header-section-number">18.2</span> Cointegration</h2>
<p>The notion of cointegration, which was given a formal treatment in <span class="citation" data-cites="Engle1987">Engle and Granger (<a href="#ref-Engle1987" role="doc-biblioref">1987</a>)</span>, makes regressions involving <span class="math inline">\(\mathrm I(1)\)</span> variables potentially meaningful.</p>
<p>If <span class="math inline">\(\{y_t: t=0,1,\ldots\}\)</span> and <span class="math inline">\(\{x_t: t=0,1,\ldots\}\)</span> are two <span class="math inline">\(\mathrm I(1)\)</span> processes, then, in general,</p>
<p><span class="math display">\[
y_t - \beta x_t
\]</span></p>
<p>is an <span class="math inline">\(\mathrm I(1)\)</span> process for any number <span class="math inline">\(\beta.\)</span> Nevertheless, it is <em>possible</em> that for some <span class="math inline">\(\beta \ne 0,\)</span> <span class="math inline">\(y_t - \beta x_t\)</span> is an <span class="math inline">\(\mathrm I(0)\)</span> process, which means it has constant mean, constant variance, and autocorrelations that depend only on the time distance between any two variables in the series, and it is asymptotically uncorrelated.</p>
<p>If such a <span class="math inline">\(\beta\)</span> exists, we say that <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are cointegrated, and we call <span class="math inline">\(\beta\)</span> the cointegration parameter.</p>
<section id="engle-granger-test" class="level3" data-number="18.2.1">
<h3 data-number="18.2.1" class="anchored" data-anchor-id="engle-granger-test"><span class="header-section-number">18.2.1</span> Engle-Granger Test</h3>
<p>The Engle-Granger test is used for testing the <strong>existence of a long-run equilibrium relationship (cointegration)</strong> between two or more non-stationary time series.</p>
<p>It is a two-step procedure:</p>
<ol type="1">
<li><p>Estimate the Cointegrating Regression</p>
<p>Suppose <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(X_t\)</span> are non-stationary (typically <span class="math inline">\(I(1)\)</span>) series that neither has a drift. Regress: <span class="math display">\[
y_t = \alpha + \beta x_t + u_t
\]</span><br>
using OLS, and save the residuals <span class="math inline">\(\hat{u}_t\)</span>.</p></li>
<li><p>Test the Residuals for Stationarity</p>
<p>Apply the Dickey-Fuller (DF) test or Augmented Dickey-Fuller (ADF) test to the residuals:<br>
<span class="math display">\[
\Delta \hat{u}_t = \alpha + \theta \hat{u}_{t-1} + \sum_{i=1}^p \gamma_i \Delta \hat{u}_{t-i} + \varepsilon_t
\]</span><br>
If the residuals are stationary (i.e., reject the null of a unit root), the variables are <strong>cointegrated</strong>.</p>
<p>We compare the <span class="math inline">\(t\)</span> statistic of <span class="math inline">\(\hat{\theta}\)</span> to the critical value in the following table. If the <span class="math inline">\(t\)</span> statistic is below the critical value, we have evidence that <span class="math inline">\(y_t - \beta x_t\)</span> is <span class="math inline">\(\mathrm I(0)\)</span> for some <span class="math inline">\(\beta;\)</span> that is, <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are cointegrated.</p></li>
</ol>
<table style="border-collapse: collapse; margin: 20px auto; text-align: center; font-family: Arial, sans-serif; width: 80%;">
<caption style="caption-side: top; background-color: #00a9e0; color: white; font-weight: bold; padding: 10px; text-align: left;">
Asymptotic Critical Values for Cointegration <em>t</em> Test: No Time Trend
</caption>
<tbody>
<tr style="background-color: #f2e6cd; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Significance level
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
1%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
2.5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
10%
</td>
</tr>
<tr style="background-color: #eef7fc; color: black; text-align: center;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Critical value
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.90
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.59
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.34
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.04
</td>
</tr>
</tbody>
</table>
<p>Note that we must get a <span class="math inline">\(t\)</span> statistic much larger in magnitude to find cointegration than if we used the usual DF critical values. This happens because OLS, which minimizes the sum of squared residuals, tends to produce residuals that look like an <span class="math inline">\(\mathrm I(0)\)</span> sequence even if <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are not cointegrated.</p>
<p>If <span class="math inline">\(y_t\)</span> and/or <span class="math inline">\(x_t\)</span> contain a drift term, we change the regression to</p>
<p><span class="math display">\[
y_t = \alpha + \delta t + \beta x_t + u_t ,
\]</span> and apply the usual DF or ADF test to the residuals <span class="math inline">\(\hat{u}_t.\)</span> The asymptotic critical values are given as follows.</p>
<table style="border-collapse: collapse; margin: 20px auto; text-align: center; font-family: Arial, sans-serif; width: 80%;">
<caption style="caption-side: top; background-color: #00a9e0; color: white; font-weight: bold; padding: 10px; text-align: left;">
Asymptotic Critical Values for Cointegration <em>t</em> Test: Linear Time Trend
</caption>
<tbody>
<tr style="background-color: #f2e6cd; color: black;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Significance level
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
1%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
2.5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
5%
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
10%
</td>
</tr>
<tr style="background-color: #eef7fc; color: black; text-align: center;">
<td style="border: 1px solid #00a9e0; padding: 10px; text-align: left;">
Critical value
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−4.32
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−4.03
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.78
</td>
<td style="border: 1px solid #00a9e0; padding: 10px;">
−3.50
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cointegrated-series" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="cointegrated-series"><span class="header-section-number">18.3</span> Cointegrated Series</h2>
<section id="leads-and-lags-estimator" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="leads-and-lags-estimator"><span class="header-section-number">18.3.1</span> Leads and Lags Estimator</h3>
<p>When <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are <span class="math inline">\(\mathrm I(1)\)</span> and cointegrated, we can write</p>
<p><span class="math display">\[
y_t = \alpha + \beta x_t + u_t ,
\]</span> where <span class="math inline">\(\{u_t\}\)</span> is a zero mean, <span class="math inline">\(\mathrm I(0)\)</span> process.</p>
<p>We want to test hypotheses about the cointegrating parameter <span class="math inline">\(\beta.\)</span></p>
<p>Generally, <span class="math inline">\(\{u_t\}\)</span> contains serial correlation, but this does NOT affect consistency of OLS. That is, OLS yields consistent estimates for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\alpha.\)</span></p>
<p>The issue is: because <span class="math inline">\(x_t\)</span> is <span class="math inline">\(\mathrm I(1),\)</span> the usual inference procedures do NOT necessarily apply. OLS is not asymptotically normally distributed, and the t statistic for <span class="math inline">\(\hat{\beta}\)</span> does not necessarily have an approximate <span class="math inline">\(t\)</span> distribution.</p>
<p>If <span class="math inline">\(\{x_t\}\)</span> is strictly exogenous, and the errors are homoskedastic, serially uncorrelated, and normally distributed, the OLS estimator is also normally distributed (conditional on the explanatory variables) and the <span class="math inline">\(t\)</span> statistic has an exact <span class="math inline">\(t\)</span> distribution.</p>
<p>Unfortunately, these assumptions are too strong to apply to most situations. The notion of cointegration implies nothing about the relationship between <span class="math inline">\(\{x_t\}\)</span> and <span class="math inline">\(\{u_t\}\)</span>—indeed, they can be arbitrarily correlated.</p>
<p>The <strong>lack of strict exogeneity</strong> of <span class="math inline">\(\{x_t\}\)</span> can be fixed by writing <span class="math inline">\(u_t\)</span> as a function of the <span class="math inline">\(\Delta x_s\)</span> for all <span class="math inline">\(s\)</span> close to <span class="math inline">\(t.\)</span></p>
<p>For example,</p>
<p><span class="math display">\[
u_t = \eta + \phi_0 \Delta x_t + \phi_1 \Delta x_{t-1} + \phi_2 \Delta x_{t-2} + \gamma_1 \Delta x_{t+1} + \gamma_2 \Delta x_{t+2} + e_t ,
\]</span></p>
<p>where, by construction, <span class="math inline">\(e_t\)</span> is uncorrelated with each of <span class="math inline">\(\Delta x_s\)</span> appearing in the equation.</p>
<p>Plugging in <span class="math inline">\(u_t\)</span> into the original regression, we get</p>
<p><span id="eq-cointegrating-par"><span class="math display">\[
\begin{split}
y_t &amp;= \alpha_0 + \beta x_t  + \phi_0 \Delta x_t + \phi_1 \Delta x_{t-1} + \phi_2 \Delta x_{t-2} \\
&amp;\phantom{=} \;+ \gamma_1 \Delta x_{t+1} + \gamma_2 \Delta x_{t+2} + e_t .
\end{split}
\tag{18.4}\]</span></span></p>
<p>The OLS estimator of <span class="math inline">\(\beta\)</span> from (<a href="#eq-cointegrating-par" class="quarto-xref"><span>18.4</span></a>) is called the <strong>leads and lags estimator</strong> because it employs <span class="math inline">\(\Delta x.\)</span></p>
<p>This equation looks a bit strange because future <span class="math inline">\(\Delta x_{s}\)</span> appear with both current and lagged <span class="math inline">\(\Delta x_{t}.\)</span> The key is that the coefficient on <span class="math inline">\(x_t\)</span> is still <span class="math inline">\(\beta\)</span>, and, by construction, <span class="math inline">\(x_t\)</span> is now strictly exogenous in this equation.</p>
<p>The strict exogeneity assumption is the important condition needed to obtain an approximately normal <span class="math inline">\(t\)</span> statistic for <span class="math inline">\(\hat\beta\)</span>. If <span class="math inline">\(u_t\)</span> is uncorrelated with all <span class="math inline">\(\Delta x_{s},\)</span> <span class="math inline">\(x\ne t\)</span>, then we can drop the leads and lags of the changes and simply include the contemporaneous change,<span class="math inline">\(\Delta x_{t}.\)</span> Then, the equation we estimate looks more standard but still includes the first difference of <span class="math inline">\(x_t\)</span> along with its level: <span class="math display">\[
y_t = \alpha_0 + \beta x_t  + \phi_0 \Delta x_t + e_t .
\]</span> In effect, adding <span class="math inline">\(\Delta x_{t}\)</span> solves any contemporaneous endogeneity between <span class="math inline">\(x_t\)</span> and <span class="math inline">\(u_t\)</span>.</p>
<p>The only issue we must worry about in (<a href="#eq-cointegrating-par" class="quarto-xref"><span>18.4</span></a>) is the possibility of serial correlation in <span class="math inline">\(\{e_t\}.\)</span> This can be dealt with by</p>
<ul>
<li>using a serial correlation-robust standard error for <span class="math inline">\(\hat\beta;\)</span> or</li>
<li>using a standard AR(1) correction, e.g., Cochrane-Orcutt (CO) estimation and Prais-Winston (PW) estimation. (See chap 12.3, Wooldridge, Introductory Econometrics)</li>
</ul>
</section>
</section>
<section id="error-correction-models" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="error-correction-models"><span class="header-section-number">18.4</span> Error Correction Models</h2>
<p>Consider the model</p>
<p><span class="math display">\[
\Delta y_t = \alpha_0 + \alpha_1 \Delta y_{t-1} + \gamma_0 \Delta x_t + \gamma_1\Delta x_{t-1} + u_t,  
\]</span></p>
<p>where <span class="math inline">\(u_t\)</span> has zero mean given <span class="math inline">\(\Delta y_{t-1},\)</span> <span class="math inline">\(\Delta x_t,\)</span> <span class="math inline">\(\Delta x_{t-1},\)</span> and further lags.</p>
<p>If <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are cointegrated with parameter <span class="math inline">\(\beta,\)</span> then we can include lags of</p>
<p><span class="math display">\[
s_t = y_t - \beta x_t
\]</span> in the equation.</p>
<p>In the simplest case, we include one lag of <span class="math inline">\(s_t:\)</span></p>
<p><span id="eq-error_correction_model"><span class="math display">\[
\Delta y_t = \alpha_0 + \alpha_1 \Delta y_{t-1} + \gamma_0 \Delta x_t + \gamma_1\Delta x_{t-1} + \delta s_{t-1} + u_t,  
\tag{18.5}\]</span></span> where <span class="math inline">\(\E[u_t\mid \Ical_{t-1}] =0,\)</span> and <span class="math inline">\(\Ical_{t-1}\)</span> contains information on all past values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y.\)</span></p>
<p>The terms <span class="math inline">\(\delta s_{t-1} = \delta (y_{t-1} - \beta x_{t-1})\)</span> is called the error correction term and the model (<a href="#eq-error_correction_model" class="quarto-xref"><span>18.5</span></a>) is called the error correction model.</p>
<p>For simplicity, consider the model without lags of <span class="math inline">\(\Delta y_t\)</span> and <span class="math inline">\(\Delta x_t:\)</span></p>
<p><span class="math display">\[
\Delta y_t = \alpha_0 + \gamma_0 \Delta x_t +  \delta (y_{t-1} - \beta x_{t-1}) + u_t,  
\]</span> where <span class="math inline">\(\delta&lt;0.\)</span></p>
<ul>
<li>If <span class="math inline">\(y_{t-1} &gt; \beta x_{t-1},\)</span> then <span class="math inline">\(y\)</span> in the previous period has overshot the equilibrium; because <span class="math inline">\(\delta&lt;0,\)</span> the error correction term works to push <span class="math inline">\(y\)</span> back toward the equilibrium.</li>
<li>If <span class="math inline">\(y_{t-1} &lt; \beta x_{t-1},\)</span> the error correction term works includes a positive change in <span class="math inline">\(y\)</span> back toward the equilibrium.</li>
</ul>
<p>The cointegrating parameter <span class="math inline">\(\beta\)</span> can be estimated using the OLS estimator or the leads and lags estimator. <span class="citation" data-cites="Engle1987">Engle and Granger (<a href="#ref-Engle1987" role="doc-biblioref">1987</a>)</span> shows that the asymptotic efficiency of the estimators of the parameters in the error correction model is unaffected by the preliminary estimation of <span class="math inline">\(\beta.\)</span></p>
<p>The choice of <span class="math inline">\(\hat\beta\)</span> will generally have an effect on the estimated error correction parameters in any particular sample, but we have no systematic way of deciding which preliminary estimator of <span class="math inline">\(\beta\)</span> to use. The procedure of replacing <span class="math inline">\(\beta\)</span> with <span class="math inline">\(\hat\beta\)</span> is called the <strong>Engle-Granger two-step procedure</strong>.</p>
</section>
<section id="noncointegrated-series" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="noncointegrated-series"><span class="header-section-number">18.5</span> Noncointegrated Series</h2>
<p>If <span class="math inline">\(y_t\)</span> and <span class="math inline">\(x_t\)</span> are <span class="math inline">\(\mathrm I(1)\)</span> and are NOT cointegrated, we can estimate a dynamic model in <strong>first differences</strong>.</p>
<p>As an example,</p>
<p><span class="math display">\[
\Delta y_t = \alpha_0 + \alpha_1 \Delta y_{t-1} + \gamma_0 \Delta x_t + \gamma_1\Delta x_{t-1} + u_t,  
\]</span></p>
<p>where <span class="math inline">\(u_t\)</span> has zero mean given <span class="math inline">\(\Delta y_{t-1},\)</span> <span class="math inline">\(\Delta x_t,\)</span> <span class="math inline">\(\Delta x_{t-1},\)</span> and further lags.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Engle1987" class="csl-entry" role="listitem">
Engle, Robert F, and C W J Granger. 1987. <span>“Co-Integration and Error Correction: Representation, Estimation, and Testing.”</span> <em>Econometrica</em> 55: 251–76. <a href="http://www.jstor.org/stable/1913236">http://www.jstor.org/stable/1913236</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./TS04_Spurious_regression.html" class="pagination-link" aria-label="Spurious Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Spurious Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./TS05_Forecast.html" class="pagination-link" aria-label="Forecast">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Forecast</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>