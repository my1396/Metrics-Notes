<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; Dynamic Models – Metrics Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./PA06_dynamic_models_with_pdynmc.html" rel="next">
<link href="./PA04_Random-Effects.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-8ef56b68f8fa1e9d2ba328e99e439f80.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-13584eca99d870fe07357c15139acc5f.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-20cbe20b4af8f742c845e3e6303c86d8.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
 
<!-- This is what works with Quarto and MathJax 3+ -->
<script>
  MathJax = {
    tex: {
      inlineMath: [   // start/end delimiter pairs for in-line math
          ['$', '$'],
          ['\\(', '\\)']
        ],
      displayMath: [  // start/end delimiter pairs for display math
        ['$$', '$$'],
        ['\\[', '\\]']
      ],
      processEscapes: true, // use \$ to produce a literal dollar sign
      tags: 'ams',  // should be 'ams', 'none', or 'all'
      macros: {  //define TeX macros
        bold: ["{\\boldsymbol #1}", 1],  // use \bold as a shorthand
        indep: "{\\perp \\!\\!\\! \\perp}",
        vect: ["\\mathbf{#1}", 1],
        mat: ["\\mathbf{#1}", 1], 

        bA: "\\boldsymbol{A}",
        bB: "\\boldsymbol{B}",
        bC: "\\boldsymbol{C}",
        bD: "\\boldsymbol{D}",
        bE: "\\boldsymbol{E}",
        bF: "\\boldsymbol{F}",
        bG: "\\boldsymbol{G}",
        bH: "\\boldsymbol{H}",
        bI: "\\boldsymbol{I}",
        bJ: "\\boldsymbol{J}",
        bK: "\\boldsymbol{K}",
        bL: "\\boldsymbol{L}",
        bM: "\\boldsymbol{M}",
        bN: "\\boldsymbol{N}",
        bP: "\\boldsymbol{P}",
        bQ: "\\boldsymbol{Q}",
        bR: "\\boldsymbol{R}",
        bS: "\\boldsymbol{S}",
        bT: "\\boldsymbol{T}",
        bU: "\\boldsymbol{U}",
        bV: "\\boldsymbol{V}",
        bW: "\\boldsymbol{W}",
        bX: "\\boldsymbol{X}",
        bY: "\\boldsymbol{Y}",
        bZ: "\\boldsymbol{Z}",
        ba: "\\boldsymbol{a}",
        bb: "\\boldsymbol{b}",
        bc: "\\boldsymbol{c}",
        bd: "\\boldsymbol{d}",
        be: "\\boldsymbol{e}",
        bg: "\\boldsymbol{g}",
        bh: "\\boldsymbol{h}",
        bi: "\\boldsymbol{i}",
        bm: "\\boldsymbol{m}",
        bp: "\\boldsymbol{p}",
        bq: "\\boldsymbol{q}",
        br: "\\boldsymbol{r}",
        bs: "\\boldsymbol{s}",
        bt: "\\boldsymbol{t}",
        bu: "\\boldsymbol{u}",
        bv: "\\boldsymbol{v}",
        bw: "\\boldsymbol{w}",
        bx: "\\boldsymbol{x}",
        by: "\\boldsymbol{y}",

        Acal: "\\mathcal{A}",
        Bcal: "\\mathcal{B}",
        Ccal: "\\mathcal{C}",
        Dcal: "\\mathcal{D}",
        Ecal: "\\mathcal{E}",
        Fcal: "\\mathcal{F}",
        Gcal: "\\mathcal{G}",
        Hcal: "\\mathcal{H}",
        Ical: "\\mathcal{I}",
        Jcal: "\\mathcal{J}",
        Kcal: "\\mathcal{K}",
        Lcal: "\\mathcal{L}",
        Mcal: "\\mathcal{M}",
        Ncal: "\\mathcal{N}",
        Ocal: "\\mathcal{O}",
        Pcal: "\\mathcal{P}",
        Qcal: "\\mathcal{Q}",
        Rcal: "\\mathcal{R}",
        Scal: "\\mathcal{S}",
        Tcal: "\\mathcal{T}",
        Ucal: "\\mathcal{U}",
        Vcal: "\\mathcal{V}",
        Wcal: "\\mathcal{W}",
        Xcal: "\\mathcal{X}",
        Ycal: "\\mathcal{Y}",
        Zcal: "\\mathcal{Z}",

        A: "\\mathbb{A}",
        B: "\\mathbb{B}",
        C: "\\mathbb{C}",
        D: "\\mathbb{D}",
        E: "\\mathbb{E}",
        F: "\\mathbb{F}",
        G: "\\mathbb{G}",
        H: "\\mathbb{H}",
        I: "\\mathbb{I}",
        J: "\\mathbb{J}",
        K: "\\mathbb{K}",
        L: "\\mathbb{L}",
        M: "\\mathbb{M}",
        N: "\\mathbb{N}",
        O: "\\mathbb{O}",
        P: "\\mathbb{P}",
        Q: "\\mathbb{Q}",
        R: "\\mathbb{R}",
        S: "\\mathbb{S}",
        T: "\\mathbb{T}",
        U: "\\mathbb{U}",
        V: "\\mathbb{V}",
        W: "\\mathbb{W}",
        X: "\\mathbb{X}",
        Y: "\\mathbb{Y}",
        Z: "\\mathbb{Z}",

        bAlpha: "\\boldsymbol{\\Alpha}",
        bBeta: "\\boldsymbol{\\beta}",
        bDelta: "\\boldsymbol{\\delta}",
        bEta: "\\boldsymbol{\\eta}",
        bGamma: "\\boldsymbol{\\Gamma}",
        bLambda: "\\boldsymbol{\\Lambda}",
        bOmega: "\\boldsymbol{\\Omega}",
        bPhi: "\\boldsymbol{\\Phi}",
        bPi: "\\boldsymbol{\\Pi}",
        bPsi: "\\boldsymbol{\\Psi}",
        bSigma: "\\boldsymbol{\\Sigma}",
        bTau: "\\boldsymbol{\\tau}",
        bXi: "\\boldsymbol{\\Xi}",
        bLambda: "\\boldsymbol{\\Lambda}",
        
        balpha: "\\boldsymbol{\\alpha}",
        bbeta: "\\boldsymbol{\\beta}",
        bepsilon: "\\boldsymbol{\\epsilon}",
        bvarepsilon: "\\boldsymbol{\\varepsilon}",
        bdelta: "\\boldsymbol{\\delta}",
        blambda: "\\boldsymbol{\\lambda}",
        bmu: "\\boldsymbol{\\mu}",
        bphi: "\\boldsymbol{\\phi}",
        bpi: "\\boldsymbol{\\pi}",
        bpsi: "\\boldsymbol{\\psi}",
        brho: "\\boldsymbol{\\rho}",
        bsigma: "\\boldsymbol{\\sigma}",
        btau: "\\boldsymbol{\\tau}",
        bxi: "\\boldsymbol{\\xi}",
        bEta: "\\boldsymbol{\\eta}",
        bPhi: "\\boldsymbol{\\Phi}",
        bPi: "\\boldsymbol{\\Pi}",
        bPsi: "\\boldsymbol{\\Psi}",
        bXi: "\\boldsymbol{\\Xi}",
        blambda: "\\boldsymbol{\\lambda}",
        bmu: "\\boldsymbol{\\mu}",
        bphi: "\\boldsymbol{\\phi}",
        bpi: "\\boldsymbol{\\pi}",
        bpsi: "\\boldsymbol{\\psi}",
        brho: "\\boldsymbol{\\rho}",
        bsigma: "\\boldsymbol{\\sigma}",
                   
        curl: ["\\left\\lbrace#1\\right\\rbrace", 1],
        floor: ["\\left\\lfloor#1\\right\\rfloor", 1],
        ceil: ["\\left\\lceil#1\\right\\rceil", 1],
        abs: ["\\left\\lvert#1\\right\\rvert", 1],
        norm: ["\\left\\lVert#1\\right\\rVert", 1],

        independent: "\\mathrel{\\perp\\!\\!\\perp}",

        var: "\\mathrm{Var}",
        cov: "\\mathrm{Cov}",
        cor: "\\mathrm{Corr}",
        diag: "\\mathrm{diag}",
        rank: "\\mathrm{rank}",
        vecc: "\\mathrm{vec}",
      }
    }
  };
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./PA01_Pooled_regression.html">Panel Data</a></li><li class="breadcrumb-item"><a href="./PA05_dynamic_models.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dynamic Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Metrics Notes</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Probability Refresher</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conditional_expectation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Expectation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measure_theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Measure Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_AR1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">AR(1)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_AR_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">AR – Example</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_phillips-curve.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Phillips Curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS01_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">TS Examples</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS02_lag_poly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lag polynomials</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS02_AR-MA-representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">AR(1) and Its MA representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS03_finite-property.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">OLS Finite Sample Assumptions and Properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS03_asymptotic-property.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">OLS Asymptotic Assumptions and Properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_TimeSeries_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Time Series Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_Spurious_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Spurious Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TS04_highly-persistent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Highly Persistent TS</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Panel Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA01_Pooled_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Pooled Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA02_Panel_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Panel Regressions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA03_Fixed-Effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Fixed Effects Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA04_Random-Effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Random Effects Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA05_dynamic_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dynamic Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA06_dynamic_models_with_pdynmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Dynamic Model Applications with <code>pdynmc</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PA07_Hetero_lm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Linear Models with Heterogeneous Coefficients</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exogeneity-and-dynamic-models" id="toc-exogeneity-and-dynamic-models" class="nav-link active" data-scroll-target="#exogeneity-and-dynamic-models"><span class="header-section-number">19.1</span> Exogeneity and Dynamic Models</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">19.1.1</span> Introduction</a></li>
  <li><a href="#no-strict-exogeneity-in-the-presence-of-lagged-dependent-variables" id="toc-no-strict-exogeneity-in-the-presence-of-lagged-dependent-variables" class="nav-link" data-scroll-target="#no-strict-exogeneity-in-the-presence-of-lagged-dependent-variables"><span class="header-section-number">19.1.2</span> No Strict Exogeneity In the Presence of Lagged Dependent Variables</a></li>
  </ul></li>
  <li><a href="#dynamic-panel-representation" id="toc-dynamic-panel-representation" class="nav-link" data-scroll-target="#dynamic-panel-representation"><span class="header-section-number">19.2</span> Dynamic Panel Representation</a>
  <ul class="collapse">
  <li><a href="#iv-estimator-of-dynamic-panel-models" id="toc-iv-estimator-of-dynamic-panel-models" class="nav-link" data-scroll-target="#iv-estimator-of-dynamic-panel-models"><span class="header-section-number">19.2.1</span> IV Estimator of Dynamic Panel Models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./PA01_Pooled_regression.html">Panel Data</a></li><li class="breadcrumb-item"><a href="./PA05_dynamic_models.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dynamic Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dynamic Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="exogeneity-and-dynamic-models" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="exogeneity-and-dynamic-models"><span class="header-section-number">19.1</span> Exogeneity and Dynamic Models</h2>
<section id="introduction" class="level3" data-number="19.1.1">
<h3 data-number="19.1.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">19.1.1</span> Introduction</h3>
<p>Consider the model</p>
<p><span class="math display">\[
y_{it} = \bx_{it}' \bbeta + u_{it} .
\]</span> Throughout the previous section, we assumed that the idiosyncratic term <span class="math inline">\(u_{it}\)</span> satisfied <strong>strict exogeneity</strong> with respect to the data: <span class="math display">\[
    \E[u_{it}|\bX_i] = 0.
\]</span></p>
<p>It implies that for all pairs of indices <span class="math inline">\(s\)</span> and <span class="math inline">\(t,\)</span> it holds that <span id="eq-dynamic-interlude-strict-orthogonality"><span class="math display">\[
    \E[u_{it}\bx_{is}] =0.
\tag{19.1}\]</span></span></p>
<ul>
<li><p>However, strict exogeneity is not possible in the presence of lagged dependent variables.</p>
<p>Therefore, <strong>sequential exogeneity</strong> requires only (<a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref"><span>19.1</span></a>) holds for <span class="math inline">\(t\ge s.\)</span> That is,</p>
<p><span id="eq-dynamic-interlude-seq-orthogonality"><span class="math display">\[
  \E[u_{it}\bx_{is}] = 0 \text{ for } t\ge s.
   \tag{19.2}\]</span></span></p>
<p>In plain language, the current and past values of <span class="math inline">\(\bx\)</span> are uncorrelated with the current error term, although its future values may not be.</p>
<p>In this case, the regressor <span class="math inline">\(\bx\)</span> is called “<strong>predetermined</strong>” as its value is <em>determined prior to the current period</em>.</p>
<p>Examples of predetermined variables:</p>
<ul>
<li>Lagged dependent variables: Variables that represent past values of the dependent variable.</li>
<li>Exogenous variables: Variables that are determined outside the model and are not influenced by the endogenous variables within the current period.</li>
</ul></li>
<li><p>For <span class="math inline">\(t&lt;s\)</span>, <a href="#eq-dynamic-interlude-strict-orthogonality" class="quarto-xref">Equation&nbsp;<span>19.1</span></a> means that <em>past</em> shocks are uncorrelated with <em>future</em> values of <span class="math inline">\(\bx\)</span>. In other words, one cannot predict <em>future</em> <span class="math inline">\(\bx\)</span>’s from <em>past</em> shocks.</p>
<p>This requirement might <strong>fail</strong> if <span class="math inline">\(\bx\)</span> is dynamic, e.g., covaraites including lagged dependent variables, and its evolution is affected by <span class="math inline">\(u_{it}\)</span>. That is, <span class="math display">\[
  \E[u_{it}\bx_{is}] \ne 0 \text{ for } t&lt;s.
  \]</span> This means, <span class="math inline">\(\bx_{is}\)</span> can respond dynamically to past values of <span class="math inline">\(y_{it}.\)</span></p>
<p>In this section, we will discuss this challenge and some traditional approaches to dealing with it with short panel data.</p></li>
</ul>
</section>
<section id="no-strict-exogeneity-in-the-presence-of-lagged-dependent-variables" class="level3" data-number="19.1.2">
<h3 data-number="19.1.2" class="anchored" data-anchor-id="no-strict-exogeneity-in-the-presence-of-lagged-dependent-variables"><span class="header-section-number">19.1.2</span> No Strict Exogeneity In the Presence of Lagged Dependent Variables</h3>
<p>Consider the AR(1) model, <span id="eq-AR1"><span class="math display">\[
y_t = \beta_0 + \beta_1 y_{t-1} + u_t,
\tag{19.3}\]</span></span> where the error <span class="math inline">\(u_t\)</span> has a zero expected value, given all past values of <span class="math inline">\(y\)</span>: <span id="eq-zero_mean"><span class="math display">\[
\mathbb{E}(u_t \mid y_{t-1}, y_{t-2}, \ldots) = 0.
\tag{19.4}\]</span></span></p>
<p>Conventions for <span class="math inline">\(t\)</span>:</p>
<ul>
<li><p>The first observation is <span class="math inline">\(y_1\)</span>, and <span class="math inline">\(t=2, \ldots, T\)</span>, so that the first available equation is</p>
<p><span class="math display">\[
  y_2 = \beta_0 + \beta_1 y_{1} + u_2 .
  \]</span></p>
<p>and there are (<span class="math inline">\(T-1\)</span>) equations in levels. We will mostly use this convention.</p></li>
<li><p>The first observation is <span class="math inline">\(y_0\)</span>, and <span class="math inline">\(t=1, \ldots, T\)</span>, so that the first available equation is</p>
<p><span class="math display">\[
  y_1 = \beta_0 + \beta_1 y_{0} + u_1 .
  \]</span></p>
<p>and there are (<span class="math inline">\(T\)</span>) equations in levels.</p></li>
</ul>
<p>Combined, these two equations imply that <span class="math display">\[
\mathbb{E}(y_t \mid y_{t-1}, y_{t-2}, \ldots) = \mathbb{E}(y_t \mid y_{t-1}) = \beta_0 + \beta_1 y_{t-1}.
\]</span></p>
<p>This result is very important. First, it means that, once <span class="math inline">\(y\)</span> lagged one period has been controlled for, no further lags of <span class="math inline">\(y\)</span> affect the expected value of <span class="math inline">\(y_t\)</span>. (This is where the name “first order” originates.) Second, the relationship is assumed to be linear.</p>
<p>Because <span class="math inline">\(x_t\)</span> contains only <span class="math inline">\(y_{t-1}\)</span>, <a href="#eq-zero_mean" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> implies that the <strong>contemporaneous exogeneity</strong> Assumption holds. By contrast, the strict exogeneity assumption needed for unbiasedness, which does not hold.</p>
<p>In fact, because <span class="math inline">\(u_t\)</span> is uncorrelated with <span class="math inline">\(y_{t-1}\)</span> under <a href="#eq-zero_mean" class="quarto-xref">Equation&nbsp;<span>19.4</span></a>, <span class="math inline">\(u_t\)</span> and <span class="math inline">\(y_t\)</span> must be correlated.</p>
<p><span class="math display">\[
\begin{aligned}
\text{Cov}(y_t, u_t) &amp;= \text{Cov}(\beta_0 + \beta_1 y_{t-1} + u_t, u_t) \\
&amp;= \text{Var}(u_t) &gt; 0.
\end{aligned}
\]</span></p>
<p>Therefore, a model with a lagged dependent variable <strong>cannot</strong> satisfy the strict exogeneity assumption.</p>
<p>For the weak dependence condition to hold, we must assume that <span class="math inline">\(|\beta_1| &lt; 1\)</span>. If this condition holds, then the OLS estimator from the regression of <span class="math inline">\(y_t\)</span> on <span class="math inline">\(y_{t-1}\)</span> produces <strong>consistent</strong> estimators of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>Unfortunately, <span class="math inline">\(\hat{\beta}_1^{OLS}\)</span> is <strong>biased</strong>, and this <em>bias can be large if the sample size is small</em> or if <span class="math inline">\(\beta_1\)</span> is <em>near</em> 1. (For <span class="math inline">\(\beta_1\)</span> near 1, <span class="math inline">\(\hat{\beta}_1^{OLS}\)</span> can have a severe downward bias.) In moderate to large samples, <span class="math inline">\(\hat{\beta}_1^{OLS}\)</span> should be a good estimator of <span class="math inline">\(\beta_1\)</span>.</p>
<p><a href="#eq-zero_mean" class="quarto-xref">Equation&nbsp;<span>19.4</span></a> is called the <strong>sequential exogeneity</strong> assumption. Or more generally, using <span class="math inline">\(\bx\)</span> to represent the vector of covariates, the sequential exogeneity is:</p>
<p><span id="eq-seq_exogeneity"><span class="math display">\[
\E(u_t \mid \bx_t, \bx_{t-1}, \ldots,) = \E(u_t) = 0, t=1,2,\ldots.
\tag{19.5}\]</span></span></p>
<p>We can see that sequential exogeneity implies contemporaneous exogeneity.</p>
</section>
</section>
<section id="dynamic-panel-representation" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="dynamic-panel-representation"><span class="header-section-number">19.2</span> Dynamic Panel Representation</h2>
<p>Dynamic models account for temporal dependencies by including the lagged dependent variable, often providing more accurate results than static panel models.</p>
<p>A Nickell bias arises from including the lagged dependent variable as an explanatory variable, making standard panel data estimators (FE, RE, FD) inconsistent, especially in analyses with short T and large N. System-GMM estimation addresses this by instrumenting the endogenous variables with their lagged values.</p>
<p>More generally, consider a panel data linear model with homogeneous coefficients, a random intercept, and a dynamic process in the <span class="math inline">\(K\)</span>-th order for the outcome: <span id="eq-dynamic-interlude-dynamic-panel"><span class="math display">\[
y_{it} = \alpha_i + \sum_{k=1}^K \lambda_k y_{it-k} + \bbeta'\bx_{it} + u_{it}.  
\tag{19.6}\]</span></span></p>
<p>Notice that the RHS now includes the lagged dependent variables <span class="math inline">\(y_{i,t-k},\)</span> <span class="math inline">\(k=1,\ldots,K.\)</span> <span class="math inline">\(\lambda_k\)</span> are the autoregressive coefficients, <span class="math inline">\(\bx_{it}\)</span> is a vector of regressors. <span class="math inline">\(\alpha_i\)</span> is an individual-effect, and <span class="math inline">\(u_{it}\)</span> is an idiosyncratic error.</p>
<p>It is conventional to assume that <span class="math inline">\(\alpha_i\)</span> and the error <span class="math inline">\(u_{it}\)</span> are mutually independent</p>
<p><span class="math display">\[
\cov(\alpha_i, u_{it}) = 0,
\]</span></p>
<p>and <span class="math inline">\(u_{it}\)</span> are serially uncorrelated:</p>
<p><span class="math display">\[
\E[u_{it}u_{is}] = 0 \quad \text{for } t \ne s.
\]</span></p>
<p>Adding dynamics to a model makes major changes in the interpretation of the equation. The entire history of the LHS variable enters into the equation. Any measured influence is conditioned on this history. Any impact of <span class="math inline">\(\bx_{it}\)</span> represents the effects of <em>new</em> information.</p>
<p>In <a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref">Equation&nbsp;<span>19.6</span></a>, a sequential exogeneity assumption takes form <span class="math display">\[
     \E[u_{it}\mid \curl{y_{is-1}, \bx_{is}}_{s\leq t}] =0.
\]</span></p>
<p>For the sake of simplicity, we will discuss a simple version of model (<a href="#eq-dynamic-interlude-dynamic-panel" class="quarto-xref"><span>19.6</span></a>) without extra covariates <span class="math inline">\(\bx_{it}\)</span> and with only one lag of <span class="math inline">\(y_{it}\)</span>: <span id="eq-dynamic-interlude-dynamic-simple"><span class="math display">\[
\color{#008B45} {y_{it} = \alpha_i + \lambda y_{it-1} + u_{it}, }
\tag{19.7}\]</span></span> where <span class="math inline">\(i=1,\ldots,N,\)</span> and <span class="math inline">\(t=2,\ldots,T.\)</span> And <span class="math inline">\(u_{it}\)</span> satisfies sequential exogeneity in the form <span class="math inline">\(\E[u_{it}|y_{is}, s&lt;t] = 0.\)</span></p>
<p>A popular class of estimators that are consistent as <span class="math inline">\(N\to\infty\)</span> with <span class="math inline">\(T\)</span> fixed first transform the model to eliminate the individual effects <span class="math inline">\(\alpha_i\)</span>, and then apply instrumental variables.</p>
<p>Let us difference <a href="#eq-dynamic-interlude-dynamic-simple" class="quarto-xref">Equation&nbsp;<span>19.7</span></a> across <span class="math inline">\(t\)</span> to eliminate the random intercept <span class="math inline">\(\alpha_i\)</span>. The differenced equation takes form</p>
<p><span id="eq-dynamic-interlude-homogeneous-differenced"><span class="math display">\[
\color{#008B45} {\Delta y_{it} = \lambda \Delta y_{it-1} + \Delta u_{it}} ,
\tag{19.8}\]</span></span></p>
<p>for <span class="math inline">\(t=3,\ldots,T,\)</span> where <span class="math inline">\(\Delta y_{it} = y_{it} - y_{it-1}.\)</span> <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>19.8</span></a> seems like a simple regression equation. It is tempting to just apply OLS and regress <span class="math inline">\(\Delta y_{it}\)</span> on <span class="math inline">\(\Delta y_{it-1}\)</span>. But it turns out that <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>19.8</span></a> has an endogeneity problem. To prove this, we can show that <span class="math inline">\(\E[\Delta y_{it-1} \Delta u_{it}] \ne 0.\)</span></p>
<p>Plug in <span class="math inline">\(\Delta y_{it-1} = y_{it-1}-y_{it-2}\)</span> and <span class="math inline">\(\Delta u_{it} = u_{it}-u_{it-1}.\)</span></p>
<p><span class="math display">\[
\begin{aligned}
\E[\Delta y_{it-1} \Delta u_{it}]
&amp;= \E[(y_{it-1}-y_{it-2})(u_{it}-u_{it-1})] \\
&amp;= \underbrace{\E[y_{it-1}u_{it}]}_{0} - \underbrace{\E[y_{it-2}u_{it}]}_0 - \E[y_{it-1}u_{it-1}] + \underbrace{\E[y_{it-2}u_{it-1}]}_0 \\
&amp;= -\E[y_{it-1}u_{it-1}] \\
&amp;= -\E[(\alpha_i + \lambda y_{it-2} + u_{it-1}) u_{it-1}] \\
&amp;= -\E[u_{it-1}^2] \\
&amp;= -\sigma_u^2 \ne 0
\end{aligned}
\]</span></p>
<p>Hence we conclude that</p>
<p><span class="math display">\[
\E[\Delta y_{it-1} \Delta u_{it}] \ne 0,
\]</span> and that <span class="math inline">\(\Delta y_{it-1}\)</span> is an endogeneous regressor in the differenced <a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref">Equation&nbsp;<span>19.8</span></a>. Hence, we see that the first difference estimator is biased.</p>
<p>Note that the bias is large when <span class="math inline">\(T\)</span> is relatively small, which is common for micro data. When <span class="math inline">\(T\)</span> is large the Nickell’s bias is relatively small.</p>
<p>The dynamic panel data (DPD) models are designed to account for this endogeneity.</p>
<section id="iv-estimator-of-dynamic-panel-models" class="level3" data-number="19.2.1">
<h3 data-number="19.2.1" class="anchored" data-anchor-id="iv-estimator-of-dynamic-panel-models"><span class="header-section-number">19.2.1</span> IV Estimator of Dynamic Panel Models</h3>
<p>Given the endogeneity issue in first-differencing, instrumental variable methods offer a potential solution. We only need to find suitable instruments – variables <span class="math inline">\(z_{it}\)</span> which satisfy relevance and exogeneity conditions: <span class="math display">\[
\begin{aligned}
    \E[z_{it}\Delta y_{it-1}] \neq 0,\\
    \E[z_{it}\Delta u_{it}] = 0.
\end{aligned}
\]</span></p>
<p>In most contexts, one has to look for external variables that can serve as instruments.</p>
<p>However, model (<a href="#eq-dynamic-interlude-homogeneous-differenced" class="quarto-xref"><span>19.8</span></a>) is a very special case where one can use instruments internal to the model!</p>
<section id="the-anderson-hsiao-estimator" class="level4" data-number="19.2.1.1">
<h4 data-number="19.2.1.1" class="anchored" data-anchor-id="the-anderson-hsiao-estimator"><span class="header-section-number">19.2.1.1</span> The Anderson-Hsiao Estimator</h4>
<p>In particular, consider using twice lagged level of dependent variable <span class="math inline">\(y_{it-2}\)</span> as an instrument for <span class="math inline">\(\Delta y_{it-1}.\)</span></p>
<ul>
<li><p><strong>Relevance</strong> seems to be relatively straightforward, as the target endogenous variable <span class="math inline">\(\Delta y_{it-1} = y_{it-1}-y_{it-2}\)</span> actually has the instrument inside.</p>
<p><span class="math display">\[
  \E[y_{it-2}\Delta y_{it-1}] = \E[y_{it-2}(y_{it-1}-y_{it-2})] \ne 0.
  \]</span></p>
<p><span class="math inline">\(y_{it-2}\)</span> is correlated with the endogenous variable <span class="math inline">\(\Delta y_{it-1}.\)</span></p></li>
<li><p><strong>Exogeneity</strong> can be justified by appealing to sequential exogeneity:</p>
<p><span id="eq-ortho-cond"><span class="math display">\[  
  \E[y_{it-2}\Delta u_{it}]  = \E[y_{it-2}u_{it} - y_{it-2}u_{it-1}]=0.
   \tag{19.9}\]</span></span></p>
<p><span class="math inline">\(y_{it-2}\)</span> is not correlated with the error term <span class="math inline">\(\Delta u_{it}.\)</span> The orthogonality condition (<a href="#eq-ortho-cond" class="quarto-xref"><span>19.9</span></a>) ensures the validity of the instrument.</p></li>
</ul>
<p>Hence <span class="math inline">\(y_{it-2}\)</span> is a valid instrument for <span class="math inline">\(\Delta y_{it-1}.\)</span></p>
<p>The resulting IV estimator (<span class="math inline">\(\hat{\bbeta}_{\mathrm{iv}} = (\bZ'\bX)^{-1}(\bZ'\by)\)</span>) is known as the <span class="citation" data-cites="Anderson1982">Anderson and Hsiao (<a href="#ref-Anderson1982" role="doc-biblioref">1982</a>)</span> estimator and given by <span class="math display">\[
\begin{split}
\hat{\lambda}_{AH}^{\mathrm{iv}}
&amp;= (\bZ'\Delta\by_{-1})^{-1} (\bZ'\Delta\by)  \\
&amp;= \dfrac{ \sum_{i=1}^N \sum_{t=3}^T y_{it-2}\Delta y_{it} }{\sum_{i=1}^N \sum_{t=3}^T y_{it-2}\Delta y_{it-1} }.
\end{split}
\]</span> where</p>
<ul>
<li><span class="math inline">\(\Delta \by\)</span> is the stacked <span class="math inline">\(N(T-2)\times 1\)</span> vector of observations on <span class="math inline">\(\Delta y_{it},\)</span></li>
<li><span class="math inline">\(\Delta \by_{-1}\)</span> is the stacked <span class="math inline">\(N(T-2)\times 1\)</span> vector of observations on <span class="math inline">\(\Delta y_{i,t-1},\)</span> and</li>
<li><span class="math inline">\(\bZ\)</span> is the stacked <span class="math inline">\(N(T-2)\times 1\)</span> vector of observations on <span class="math inline">\(y_{i,t-2}.\)</span></li>
</ul>
<p>The 2SLS estimator (<span class="math inline">\(\widehat{\bbeta}_{2\text{sls}} = \left[\bX'\bZ (\bZ'\bZ)^{-1} \bZ'\bX \right]^{-1} \left[\bX'\bZ (\bZ'\bZ)^{-1} \bZ'\by \right]\)</span>) is given by</p>
<p><span class="math display">\[
\begin{split}
\hat{\lambda}_{AH}^{\text{2sls}}
&amp;= \left[\Delta\by_{-1}'\bZ (\bZ'\bZ)^{-1} \bZ'\Delta\by_{-1}\right]^{-1} \left[\Delta\by_{-1}'\bZ (\bZ'\bZ)^{-1} \bZ'\Delta\by \right]  .
\end{split}
\]</span></p>
<p>One might use the twice lagged differences <span class="math inline">\(\Delta y_{it-2} = y_{it-2}-y_{it-3}\)</span> as an instrument for <span class="math inline">\(\Delta y_{it-1}.\)</span> But</p>
<ul>
<li><p>One further time series observation is lost if <span class="math inline">\(\Delta y_{i,t-2}\)</span> rather than <span class="math inline">\(y_{it-2}\)</span> is used as the instrument.</p></li>
<li><p>Larger asymptotic variance</p></li>
</ul>
<p>The Anderson-Hsiao (AH) estimator delivers <strong>consistent but not eﬃcient</strong> estimates of the parameters in the model. This is due to the fact that the IV doesn’t exploit all the available moments conditions.</p>
<p>With <span class="math inline">\(T=3,\)</span> we have one instrument <span class="math inline">\(y_{i1}\)</span> for <span class="math inline">\(\Delta y_{i2}\)</span> in the equation</p>
<p><span class="math display">\[
\Delta y_{i3} = \lambda \Delta y_{i2} + \Delta u_{i3} , \quad \text{for } i=1,\ldots, N.
\]</span> With <span class="math inline">\(T&gt;3,\)</span> further valid instruments become available for the first differenced equations in the later time periods. Efficiency can be improved by exploiting these additional instruments.</p>
<p>The IV estimator also ignores the structure of the error component in the transformed model.</p>
<ul>
<li>The autocorrelation in the first differenced errors leads to inconsistency of the IV estimates.</li>
<li>The IV estimates would be inconsistent when other regressors are correlated with the error term.</li>
</ul>
</section>
<section id="the-arellano-bond-estimator" class="level4" data-number="19.2.1.2">
<h4 data-number="19.2.1.2" class="anchored" data-anchor-id="the-arellano-bond-estimator"><span class="header-section-number">19.2.1.2</span> The Arellano-Bond Estimator</h4>
<p>The orthogonality condition (<a href="#eq-ortho-cond" class="quarto-xref"><span>19.9</span></a>) is one of many implied by the dynamic panel model. Indeed, all lags <span class="math inline">\(y_{it-2},\)</span> <span class="math inline">\(y_{it-3},\)</span> are valid instruments. If <span class="math inline">\(T &gt; p + 2\)</span> (<span class="math inline">\(p\)</span> is the order of autocorrelation) these can be used to potentially improve estimation efficiency. This was first pointed out by <span class="citation" data-cites="Holtz-Eakin1988">Holtz-Eakin, Newey, and Rosen (<a href="#ref-Holtz-Eakin1988" role="doc-biblioref">1988</a>)</span> and further developed by <span class="citation" data-cites="Arellano1991">Arellano and Bond (<a href="#ref-Arellano1991" role="doc-biblioref">1991</a>)</span>.</p>
<p><span class="citation" data-cites="Arellano1991">Arellano and Bond (<a href="#ref-Arellano1991" role="doc-biblioref">1991</a>)</span> expanded the idea by using additional lags of the dependent variable as instruments.</p>
<p>Starting point: the FD estimator</p>
<p><span class="math display">\[
\Delta y_{it} = \lambda \Delta y_{it-1} + \Delta u_{it},
\]</span></p>
<p><strong>Valid instruments:</strong></p>
<ul>
<li><p><span class="math inline">\(t = 2 \text{ or } t = 1\)</span>: no instruments,</p></li>
<li><p><span class="math inline">\(t = 3\)</span>: the valid instrument for <span class="math inline">\(\Delta y_{i2} = (y_{i2} - y_{i1})\)</span> is <span class="math inline">\(y_{i1}\)</span>, the moment condition is</p></li>
</ul>
<p><span class="math display">\[
\E[y_{i1}\Delta u_{i3}] = 0 \text{ for }i=1,2,\ldots,N
\]</span></p>
<ul>
<li><span class="math inline">\(t = 4\)</span>: the valid instruments for <span class="math inline">\(\Delta y_{i3} = (y_{i3} - y_{i2})\)</span> are <span class="math inline">\(y_{i2}\)</span> as well as <span class="math inline">\(y_{i1}\)</span>, the moment conditions are</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\E[y_{i1}\Delta u_{i4}] &amp;= 0 \\
\E[y_{i2}\Delta u_{i4}] &amp;= 0
\end{aligned}
\]</span></p>
<ul>
<li><span class="math inline">\(t = 5\)</span>: the valid instruments for <span class="math inline">\(\Delta y_{i4} = (y_{i4} - y_{i3})\)</span> are <span class="math inline">\(y_{i3}\)</span> as well as <span class="math inline">\(y_{i2}\)</span> and <span class="math inline">\(y_{i1}\)</span>, the moment conditions are</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\E[y_{i1}\Delta u_{i5}] &amp;= 0 \\
\E[y_{i2}\Delta u_{i5}] &amp;= 0 \\
\E[y_{i3}\Delta u_{i5}] &amp;= 0 \\
\end{aligned}
\]</span></p>
<ul>
<li><span class="math inline">\(t = 6\)</span>: the valid instruments for <span class="math inline">\(\Delta y_{i5} = (y_{i5} - y_{i4})\)</span> are <span class="math inline">\(y_{i4}\)</span> as well as <span class="math inline">\(y_{i3}\)</span>, <span class="math inline">\(y_{i2}\)</span>, and <span class="math inline">\(y_{i1}\)</span>, the moment conditions are</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\E[y_{i1}\Delta u_{i6}] &amp;= 0 \\
\E[y_{i2}\Delta u_{i6}] &amp;= 0 \\
\E[y_{i3}\Delta u_{i6}] &amp;= 0 \\
\E[y_{i4}\Delta u_{i6}] &amp;= 0 \\
\end{aligned}
\]</span></p>
<ul>
<li><span class="math inline">\(t = T\)</span>: the valid instruments for <span class="math inline">\(\Delta y_{iT-1} = (y_{iT-1} - y_{iT-2})\)</span> are <span class="math inline">\(y_{iT-2}\)</span> as well as <span class="math inline">\(y_{iT-3}, \dots, y_{i1}\)</span>, the moment conditions are</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\E[y_{i1}\Delta u_{iT}] &amp;= 0 \\
\E[y_{i2}\Delta u_{iT}] &amp;= 0 \\
\E[y_{i3}\Delta u_{iT}] &amp;= 0 \\
\vdots \\
\E[y_{i,T-2}\Delta u_{iT}] &amp;= 0 \\
\end{aligned}
\]</span></p>
<p>As <span class="math inline">\(t\)</span> increases, the number of instruments available also increases. The total number of instruments will be quadratic in <span class="math inline">\(T.\)</span> One disadvantage of this strategy should be apparent. If <span class="math inline">\(T &lt;10\)</span>, that may be a manageable number, but for a longer times eries, it may be necessary to restrict the number of past lags used.</p>
<p>We’ll have an instrument matrix with one row for each time period that we are instrumenting. <span class="math inline">\(Z_i\)</span> is the corresponding matrix of instruments for the lagged difference.</p>
<p><span class="math display">\[
Z_i =
\begin{bmatrix}
y_{i,1} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; y_{i,1} &amp; y_{i,2} &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; y_{i,1} &amp; y_{i,2} &amp; y_{i,3} &amp; \cdots &amp; 0 &amp; 0  \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \cdots &amp; \vdots &amp; \vdots  \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 &amp; y_{i,1} &amp; \cdots &amp; y_{i,T-2}
\end{bmatrix}
\]</span></p>
<p>The number of rows of <span class="math inline">\(Z_i\)</span> is <span class="math inline">\(T-2.\)</span> The number of columns of <span class="math inline">\(Z_i\)</span> depends on the length of <span class="math inline">\(T,\)</span> it can grow very quickly with <span class="math inline">\(T:\)</span></p>
<p><span class="math display">\[
1+ 2 + \cdots + (T-2) = \sum_{k=1}^{T-2} k = \frac{(T-1)(T-2)}{2}
\]</span> Rewrite the model in the vector form</p>
<p><span class="math display">\[
\Delta \by_{i\cdot} = \lambda \Delta y_{i\cdot-1} + \Delta u_{i\cdot},
\]</span> where</p>
<p><span class="math display">\[
\begin{split}
\Delta y_{i\cdot} =
\begin{bmatrix}
\Delta y_{i3} \\
\Delta y_{i4} \\
\vdots \\
\Delta y_{iT}
\end{bmatrix},
\quad
\Delta y_{i\cdot-1} =
\begin{bmatrix}
\Delta y_{i2} \\
\Delta y_{i3} \\
\vdots \\
\Delta y_{i,T-1}
\end{bmatrix},
\quad
\Delta u_{i\cdot} &amp; =
\begin{bmatrix}
\Delta u_{i3} \\
\Delta u_{i4} \\
\vdots \\
\Delta u_{iT}
\end{bmatrix}.  \\
&amp; \phantom{=} (T-2) \times 1
\end{split}
\]</span></p>
<p><span class="citation" data-cites="Arellano1991">Arellano and Bond (<a href="#ref-Arellano1991" role="doc-biblioref">1991</a>)</span> suggested using a GMM approach based on all available moment conditions:</p>
<p><span class="math display">\[
\E[Z_i'\Delta u_{i\cdot}] = \boldsymbol{0}
\]</span></p>
<p>Sample analogue</p>
<p><span class="math display">\[
J_N(\lambda) = \frac{1}{N} \sum_{i=1}^N \bZ'\Delta u_{i\cdot}
\]</span></p>
<blockquote class="blockquote">
<p>Alternative notation: Sometimes you see the moment conditions as <span class="math inline">\(\E[Z_i' u_{i\cdot}^*] = \boldsymbol{0}\)</span>, where <span class="math inline">\(u_{i\cdot}^*\)</span> refers to the first difference transformed errors.</p>
</blockquote>
<p>There are all together <span class="math inline">\(\frac{(T-1)(T-2)}{2}\)</span> conditions.</p>
<p>The one-step Arellano-Bond estimator is a GMM estimator:</p>
<p><span class="math display">\[
\hat{\lambda}^{GMM} =  Q_1^{-1} \left(\sum_{i=1}^N \Delta y_{i\cdot -1}^{\prime} Z_i\right) A_1 \left(\sum_{i=1}^N Z_i' \Delta y_i \right)
\]</span> where</p>
<p><span class="math display">\[
Q_1 = \left(\sum_{i=1}^N \Delta y_{i\cdot -1}^{\prime} Z_i\right) A_1 \left(\sum_{i=1}^N Z_i'  \Delta y_{i\cdot -1} \right)
\]</span> and</p>
<p><span class="math display">\[
\begin{aligned}
A_1 &amp;= \left( \sum_{i=1}^N Z_i^\prime H_i Z_i \right)^{-1} , \\
H_i &amp;= \E[\Delta u_i \Delta u_i^{\prime}] = \sigma_u^2
\begin{bmatrix}
2 &amp; -1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
-1 &amp; 2 &amp; -1 &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; 2 &amp; -1 \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; -1 &amp; 2 \\
\end{bmatrix} .
\end{aligned}
\]</span></p>
<p><span class="math inline">\(A_1\)</span> is the optimal weighting matrix: <span class="math inline">\(H_i\)</span> is the covariance matrix of the differenced idiosyncratic errors. Note that <span class="math inline">\(H_i\)</span> implies homoskedesticity while taking into account the dynamic structure of the error term.</p>
<p>The two-step estimator is based on one-step estimator:</p>
<p><span class="math display">\[
\hat{\lambda}^{GMM} =  Q_2^{-1} \left(\sum_{i=1}^N \Delta y_{i\cdot -1}^{\prime} Z_i\right) A_2 \left(\sum_{i=1}^N Z_i' \Delta y_i \right)
\]</span> where</p>
<p><span class="math display">\[
Q_2 = \left(\sum_{i=1}^N \Delta y_{i\cdot -1}^{\prime} Z_i\right) A_2 \left(\sum_{i=1}^N Z_i'  \Delta y_{i\cdot -1} \right)
\]</span> and</p>
<p><span class="math display">\[
\begin{aligned}
A_1 &amp;= \left( \sum_{i=1}^N Z_i^\prime G_i Z_i \right)^{-1} , \\
G_i &amp;= \widehat{\Delta u_i}\; \widehat{\Delta u_i}^{\prime}  .
\end{aligned}
\]</span> That is, the only diﬀerence between one-step and two-step estimator is the weighting matrix <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span>. <span class="math inline">\(A_2\)</span> uses the one-step residual from the one-step estimation.</p>
<p>Simulation studies have suggested very modest eﬃciency gain from using the two-step version, even in the presence of considerable heteroskedasticity. More importantly the dependence of the two-step weight matrix on estimated parameters makes the usual asymptotic distribution approximations less reliable for the two step estimator. Simulation studies have shown that the asymptotic standard errors tend to be much too small for the two-step estimator. These are the reasons that much applied work has focused on the results of one-step estimator.</p>
<p>The Arellano-Bond (AB) estimator is suitable for situations with:</p>
<ul>
<li>“small <span class="math inline">\(T\)</span>, large <span class="math inline">\(N\)</span>” panels: few time periods and many individual units</li>
<li>a linear functional relationship</li>
<li>one left-hand variable that is dynamic, depending on its own past realizations</li>
<li>right-hand variables that are not strictly exogenous: correlated with past and possibly current realizations of the error</li>
<li>fixed individual effects, implying unobserved heterogeneity</li>
<li>heteroskedasticity and autocorrelation within individual units’ errors, but not across them</li>
</ul>
<p>The AB estimator is usually called <strong>difference GMM</strong>.</p>
<p>A potential weakness in the Arellano-Bond DPD estimator was revealed in later work by <span class="citation" data-cites="Arellano1995">Arellano and Bover (<a href="#ref-Arellano1995" role="doc-biblioref">1995</a>)</span> and <span class="citation" data-cites="Blundell1998">Blundell and Bond (<a href="#ref-Blundell1998" role="doc-biblioref">1998</a>)</span>.</p>
<ul>
<li><p>The lagged levels are often rather poor instruments for first differenced variables, especially if the variables are close to a random walk, i.e., <span class="math inline">\(\lambda\)</span> is close to unity.</p></li>
<li><p>For long panel (large <span class="math inline">\(T\)</span>) the number of instruments increases dramatically, i.e., <span class="math inline">\(\frac{(T-1)(T-2)}{2}.\)</span> This leads to potential loss of efficiency.</p>
<p>By using the lag limits options, you may specify, for instance, that only lags 2–5 are to be used in constructing the GMM instruments.</p></li>
<li><p>Consistency of the GMM estimator bases on the assumption that the trans- formed error term is not serially correlated for lags greater or equal to two, i.e., <span class="math inline">\(\E[\Delta u_{it} \Delta u_{it-k}] = 0\)</span> for <span class="math inline">\(k\ge 2.\)</span> It’s crucial to test whether the second-order autocorrelation is zero for all periods in the sample.</p>
<p>If a significant AR(2) statistic is encountered, the second lags of endogenous variables will not be appropriate instruments for their current values.</p></li>
<li><p>When <span class="math inline">\(T &gt; 3\)</span> and the model is over-identified, a <strong>Sargan–Hansen test</strong> can be used to test the overidentifying restrictions.</p></li>
</ul>
<p>Their modification of the estimator includes lagged levels as well as lagged differences. The expanded estimator is commonly termed <strong>System GMM</strong>. The cost of the System GMM estimator involves a set of additional restrictions on the initial conditions of the process generating <span class="math inline">\(y.\)</span></p>
</section>
</section>
</section>
<section id="references" class="level2 unlisted unnumbered">
<h2 class="unlisted unnumbered anchored" data-anchor-id="references">References</h2>
<ul>
<li>Chapter 12, “Serial Correlation and Heteroskedasticity in Time Series Regressions.” <em>Introductory Econometrics: A Modern Approach</em>, 7e by Jeffrey M. Wooldridge</li>
<li>Vladislav Morozov, “Interlude: Standard Dynamic Panel Estimators.” Econometrics with Unobserved Heterogeneity, Course material, <a href="https://vladislav-morozov.github.io/econometrics-heterogeneity/linear/linear-dynamic-panel-iv.html#extra-endogeneity-and-the-within-estimator" class="uri">https://vladislav-morozov.github.io/econometrics-heterogeneity/linear/linear-dynamic-panel-iv.html#extra-endogeneity-and-the-within-estimator</a></li>
<li>Dynamic panel in Stata: <a href="https://janditzen.github.io/xtdcce2/" class="uri">https://janditzen.github.io/xtdcce2/</a></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Anderson1982" class="csl-entry" role="listitem">
Anderson, T. W., and Cheng Hsiao. 1982. <span>“<span class="nocase">Formulation and estimation of dynamic models using panel data</span>.”</span> <em>Journal of Econometrics</em> 18 (1): 47–82. <a href="https://doi.org/10.1016/0304-4076(82)90095-1">https://doi.org/10.1016/0304-4076(82)90095-1</a>.
</div>
<div id="ref-Arellano1991" class="csl-entry" role="listitem">
Arellano, Manuel, and Stephen Bond. 1991. <span>“<span class="nocase">Some Tests of Specification for Panel Carlo Application to Data: Monte Carlo Evidence and an Application to Employment Equations</span>.”</span> <em>Review of Economic Studies</em> 58: 277–97.
</div>
<div id="ref-Arellano1995" class="csl-entry" role="listitem">
Arellano, Manuel, and Olympia Bover. 1995. <span>“<span class="nocase">Another Look at the Instrumental Variable Estimation of Error-Components Models</span>.”</span> <em>Journal of Econometrics</em> 68 (1): 29–51.
</div>
<div id="ref-Blundell1998" class="csl-entry" role="listitem">
Blundell, Richard, and Stephen Bond. 1998. <span>“<span class="nocase">Initial Conditions and Moment Restrictions in Dynamic Panel Data Models</span>.”</span> <em>Journal of Econometrics</em> 87: 115–43.
</div>
<div id="ref-Holtz-Eakin1988" class="csl-entry" role="listitem">
Holtz-Eakin, Douglas, Whitney K. Newey, and Harvey S. Rosen. 1988. <span>“<span class="nocase">Estimating Vector Autoregressions with Panel Data</span>.”</span> <em>Econometrica</em> 56 (6): 1371–95.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./PA04_Random-Effects.html" class="pagination-link" aria-label="Random Effects Model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Random Effects Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./PA06_dynamic_models_with_pdynmc.html" class="pagination-link" aria-label="Dynamic Model Applications with `pdynmc`">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Dynamic Model Applications with <code>pdynmc</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>